{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "title": {
        "text": "Earthquake Data",
        "fontSize": 30,
        "align": "center"
    },
    "params": [
        {
            "name": "selected_continent",
            "value": "All Continents",
            "bind": {
                "input": "select",
                "options": [
                    "All Continents",
                    "Asia",
                    "South America",
                    "North America",
                    "Europe",
                    "Oceania"
                ],
                "name": "Select a Continent: "
            }
        }
    ],
    "vconcat": [
        {
            "width": 1000,
            "height": 600,
            "title": "Earthquake Distribution Across Techtonic Plates (Magnitude > 6.5)",
            "projection": {
                "type": "equalEarth"
            },
            "layer": [
                {
                    "data": {
                        "url": "https://raw.githubusercontent.com/mfin0008/FIT3179-DataVis2/main/data/.topojson%20files/countries.json",
                        "format": {
                            "type": "topojson",
                            "feature": "ne_110m_admin_0_countries"
                        }
                    },
                    "mark": {
                        "type": "geoshape",
                        "fill": "black",
                        "stroke": "lightgray"
                    }
                },
                {
                    "data": {
                        "url": "https://raw.githubusercontent.com/mfin0008/FIT3179-DataVis2/main/data/.topojson%20files/graticules.json",
                        "format": {
                            "type": "topojson",
                            "feature": "ne_110m_graticules_30"
                        }
                    },
                    "mark": {
                        "type": "geoshape",
                        "fill": "",
                        "stroke": "darkgray"
                    }
                },
                {
                    "data": {
                        "url": "https://raw.githubusercontent.com/mfin0008/FIT3179-DataVis2/main/data/.topojson%20files/techtonic%20plates.json",
                        "format": {
                            "type": "topojson",
                            "feature": "PB2002_boundaries1"
                        }
                    },
                    "mark": {
                        "type": "geoshape",
                        "fill": "",
                        "stroke": "darkblue"
                    }
                },
                {
                    "data": {
                        "url": "https://raw.githubusercontent.com/mfin0008/FIT3179-DataVis2/main/data/modified_earthquake_data.csv"
                    },
                    "transform": [
                        {
                            "filter": "datum.magnitude != ''"
                        },
                        {
                            "filter": "selected_continent === 'All Continents' || datum.continent === selected_continent"
                        }
                    ],
                    "mark": {
                        "type": "point",
                        "tooltip": {
                            "content": "data"
                        }
                    },
                    "encoding": {
                        "longitude": {
                            "field": "longitude",
                            "type": "quantitative"
                        },
                        "latitude": {
                            "field": "latitude",
                            "type": "quantitative"
                        },
                        "color": {
                            "field": "magnitude",
                            "type": "quantitative",
                            "title": "Magnitude [Richter Scale]",
                            "scale": {
                                "type": "threshold",
                                "domain": [
                                    7,
                                    8
                                ],
                                "range": [
                                    "#feedde",
                                    "#fdbe85",
                                    "#d94701"
                                ]
                            },
                            "legend": {
                                "format": ".2s"
                            }
                        },
                        "opacity": {
                            "value": 1
                        },
                        "tooltip": [
                            {
                                "field": "title",
                                "type": "nominal"
                            },
                            {
                                "field": "magnitude",
                                "type": "quantitative",
                                "title": "Magnitude [Richter Scale]"
                            },
                            {
                                "field": "latitude",
                                "type": "quantitative",
                                "title": "Latitude"
                            },
                            {
                                "field": "longitude",
                                "type": "quantitative",
                                "title": "Longitude"
                            },
                            {
                                "field": "date_time",
                                "type": "nominal",
                                "title": "Date (dd-mm-yyyy)"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "hconcat": [
                {
                    "width":700,
                    "title": "Magnitude of Earthquakes over Time.",
                    "data": {
                        "url": "https://raw.githubusercontent.com/mfin0008/FIT3179-DataVis2/main/data/modified_earthquake_data.csv"
                    },
                    "transform": [
                        {
                            "filter": "datum.magnitude != ''"
                        },
                        {
                            "filter": "datum.date_time != ''"
                        },
                        {
                            "filter": "selected_continent === 'All Continents' || datum.continent === selected_continent"
                        }
                    ],
                    "mark": {
                        "type": "line",
                        "point": {
                            "filled": false,
                            "fill": "white"
                        }
                    },
                    "encoding": {
                        "x": {
                            "timeUnit": "yearmonthdate",
                            "field": "date_time"
                        },
                        "y": {
                            "field": "magnitude",
                            "type": "quantitative", 
                            "scale": {"domain": [6,9.50]}
                        },
                        "color": {
                            "field": "symbol",
                            "type": "nominal"
                        },
                        "tooltip": [
                            {
                                "field": "title",
                                "type": "nominal"
                            },
                            {
                                "field": "magnitude",
                                "type": "quantitative",
                                "title": "Magnitude [Richter Scale]"
                            },
                            {
                                "field": "latitude",
                                "type": "quantitative",
                                "title": "Latitude"
                            },
                            {
                                "field": "longitude",
                                "type": "quantitative",
                                "title": "Longitude"
                            },
                            {
                                "timeUnit": "yearmonthdate",
                                "field": "date_time",
                                "type": "nominal",
                                "title": "Date (dd-mm-yyyy)"
                            }
                        ]
                    }
                },
                {
                    "width": 200,
                    "height": 200,
                    "title": "Proportion of alert levels",
                    "layer": [
                        {
                            "data": {
                                "url": "https://raw.githubusercontent.com/mfin0008/FIT3179-DataVis2/main/data/modified_earthquake_data.csv"
                            },
                            "transform": [
                                {
                                    "filter": "datum.alert != ''"
                                },
                                {
                                    "filter": "selected_continent === 'All Continents' || datum.continent === selected_continent"
                                }
                            ],
                            "encoding": {
                                "theta": {
                                    "field": "alert",
                                    "type": "quantitative",
                                    "aggregate": "count",
                                    "stack": true
                                },
                                "color": {
                                    "field": "alert",
                                    "type": "nominal",
                                    "scale": {
                                        "range": [
                                            "#4CBB17",
                                            "#FF8A33",
                                            "#FF5733",
                                            "#FFF033",
                                            "#33A0FF"
                                        ]
                                    },
                                    "title": "Alert Level"
                                },
                                "tooltip": [
                                    {
                                        "field": "alert",
                                        "title": "Alert Level"
                                    },
                                    {
                                        "field": "alert",
                                        "type": "quantitative",
                                        "aggregate": "count",
                                        "title": "Number of Occurrences"
                                    }
                                ]
                            },
                            "layer": [
                                {
                                    "mark": {
                                        "type": "arc"
                                    }
                                },
                                {
                                    "mark": {
                                        "type": "text",
                                        "radius": 120
                                    },
                                    "encoding": {
                                        "text": {
                                            "field": "alert",
                                            "type": "nominal"
                                        }
                                    }
                                },
                                {
                                    "mark": {
                                        "type": "text",
                                        "align": "center",
                                        "baseline": "middle",
                                        "color": "black"
                                    }
                                }
                            ]
                        }
                    ]
                }
                
            ]
        }
    ]
}